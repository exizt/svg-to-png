<!doctype html>
<html>
<head>
<meta charset="utf-8"> 
<style>
canvas {
	border:1px solid #eee;
	margin: 2rem;
}
</style>
<script>
	// 가운데 적용할 svg
	var foregroundSvg = "./sample_svg/accessibility_new-24px.svg";
	
	// 배경에 적용할 svg
	var backgroundSvg = "./sample_svg/background-round.svg"

	// 변환할 사이즈 종류
	var sizes = [48, 72, 96, 144, 192];

document.addEventListener('DOMContentLoaded', function() {
	createCanvasElements();
	
	var canvasList = document.getElementsByTagName('canvas');
	for (var i = 0; i < canvasList.length; i++) {
		drawCanvas2(canvasList[i]);
	}
});


function createCanvasElements(){
	
	var container = document.getElementById('canvas-container');

	for(var i in sizes){
		createCanvas(sizes[i])
	}
}

/**
* Canvas 생성
*/
function createCanvas(size){
	var container = document.getElementById('canvas-container');

	let html = `<canvas id="canvas-${size}" width="${size}" height="${size}"></canvas>`;
	container.insertAdjacentHTML('beforeend',html);
}



function drawCanvas2(canvas)
{
	var ctx = canvas.getContext("2d");

	// 배경
	var bg = new Image()
	bg.onload = function() {
		//ctx.fillStyle = "orange";
		//ctx.drawImage(img, 0, 0, 128, 128);
		ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);
		//var png = canvas.toDataURL("image/png");
		//document.querySelector(pngContainerSelector).innerHTML = '<img src="'+png+'"/>';
		//DOMURL.revokeObjectURL(png);
	};
	bg.src = backgroundSvg;

	var img = new Image();
	img.onload = function() {
		//ctx.fillStyle = "orange";
		//ctx.drawImage(img, 0, 0, 128, 128);
		ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
		//var png = canvas.toDataURL("image/png");
		//document.querySelector(pngContainerSelector).innerHTML = '<img src="'+png+'"/>';
		//DOMURL.revokeObjectURL(png);
	};
	img.src = foregroundSvg;
}
function a(){
	var canvasList = document.getElementsByTagName('canvas');
	for (var i = 0; i < canvasList.length; i++) {
		download(canvasList[i].id)
	}
	function download(canvasId){
		
		var link = document.createElement('a');
		var filename = canvasId+'.png';
		link.download = filename
		//console.log(filename)
		link.href = document.getElementById(canvasId).toDataURL("image/png")
		link.click();
		
	}
}
</script>
</head>
<body>
<div id="canvas-container"></div>
<div id="png-container"></div>
<button onclick="a()">클릭</button>
</body>
</html>